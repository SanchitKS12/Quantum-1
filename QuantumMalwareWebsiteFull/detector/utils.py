import numpy as np
import re

class FeatureExtractor:
    """OOP feature extractor that turns raw log text into a 6D feature vector."""

    def __init__(self):
        pass

    def extract(self, raw_text: str):
        if raw_text is None:
            raw_text = ''
        s = raw_text.lower()
        length = len(s)
        digits = sum(c.isdigit() for c in s)
        file_ops = s.count('open') + s.count('read') + s.count('write') + s.count('delete')
        new_procs = s.count('exec') + s.count('process') + s.count('spawn')
        net_conn = s.count('socket') + s.count('connect') + s.count('http') + s.count('tcp')
        unusual_ft = len(re.findall(r'\.(exe|scr|bin|dll|ps1|vbs)\b', s))
        entropy = digits / (length + 1)
        vec = np.array([file_ops, digits/100.0, new_procs, net_conn, unusual_ft, entropy], dtype=float)
        return vec
