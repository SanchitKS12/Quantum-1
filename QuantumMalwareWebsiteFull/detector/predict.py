from .quantum_detector import QuantumMalwareDetector

class DetectionService:
    """Service class that wraps prediction logic using a singleton detector instance."""

    _detector = None

    @classmethod
    def get_detector(cls):
        if cls._detector is None:
            cls._detector = QuantumMalwareDetector()
        return cls._detector

    @classmethod
    def run_detection_from_features(cls, features):
        detector = cls.get_detector()
        probs = detector.predict_proba(features)
        label = detector.predict(features)[0]
        return {
            'label': 'Malicious' if int(label) == 1 else 'Benign',
            'score': float(probs[0][1]),
        }
